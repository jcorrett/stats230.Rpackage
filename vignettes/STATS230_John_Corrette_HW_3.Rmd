---
title: "STATS230 Homework #3"
author: "John Corrette"
date: "2/7/2022"
output: html_document
vignette: >
  %\VignetteIndexEntry{STATS230_John_Corrette_HW_3}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(bench)
library(ggplot2)
library(tidyr)
library(matlib)
is_available <- require(stats230.Rpackage)
if (!is_available) {
  library(devtools)
  install_github("jcorrett/stats230.Rpackage")
}
library(stats230.Rpackage) 
```

```{r Read Heart Data, warning=FALSE}
data <- read.table("http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data",
	sep=",",head=T,row.names=1)
DF <- data.frame(data)
X <- apply(as.matrix.noquote(DF),2,as.numeric)
ystr <- "chd"
#xstr <- c("tobacco","ldl","adiposity","typea","obesity","alcohol","age")
xstr <- c("ldl","age")
y <- X[, ystr]
X <- X[, xstr]
X <- scale(X) #standardize to have 0 mean columns w/ var = 1
alpha <- 1e-3
tol <- 1e-6

#gd_df <- gd_logistic_regression(X,y,alpha,tol)
#gd_beta <- gd_df[[1]]
#gd_llhood <- gd_df[[2]]
#gd_beta_CI <- gd_df[[3]]

nr_df <- nr_logistic_regression(X,y,tol)
nr_beta <- nr_df[[1]]
nr_llhood <- nr_df[[2]]
nr_beta_CI <- nr_df[[3]]

#plot(gd_llhood)
#yhat_gd <- (1/(1+exp(-X%*%gd_beta)))

plot(nr_llhood)
yhat_nr <- (1/(1+exp(-X%*%nr_beta)))

mylogit <- glm.fit(X,y,family=binomial(),intercept = FALSE)
#gd_beta
#gd_beta_CI
nr_beta
nr_beta_CI
```
